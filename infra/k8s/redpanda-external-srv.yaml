# Expose an external Redpanda (e.g., Docker Compose on the host) to k8s pods.
# Use a distinct service name to avoid clashing with the in-cluster redpanda-srv.
# Update the IP and port to match your host listener/advertise settings.
#
# For Minikube (docker driver), the host-gateway IP is typically 192.168.58.1.
# If your external listener is 19092 (OUTSIDE), point pods to this service at port 19092.
#
# After adding, point KAFKA_BROKER / KAFKA_BROKER_URL in deployments to:
#   redpanda-external-srv:19092
#
apiVersion: v1
kind: Endpoints
metadata:
  name: redpanda-external-srv
subsets:
  - addresses:
      - ip: 192.168.58.1  # host gateway IP (update if different)
    ports:
      - name: kafka
        port: 19092       # external listener port
        protocol: TCP
---
apiVersion: v1
kind: Service
metadata:
  name: redpanda-external-srv
spec:
  ports:
    - name: kafka
      port: 19092
      targetPort: 19092
      protocol: TCP
  # No selector; endpoints are manually defined above

